var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},annieUI;!function(e){var t=annie.Sprite,i=annie.Shape,n=function(e){function n(n,a,s,o){void 0===o&&(o=!0),e.call(this),this.isVertical=!0,this.viewWidth=0,this.viewHeight=0,this.maxDistance=1040,this.distance=0,this.minDis=2,this.maskObj=null,this.view=null,this.lastValue=0,this.speed=0,this.addSpeed=0,this.isStop=!0,this.maxSpeed=100,this.fSpeed=20,this.paramXY="y",this.stopTimes=-1,this.isMouseDown=!1,this.autoScroll=!1;var d=this;d._instanceType="annieUI.ScrollPage",d.isVertical=o,d.view=new t,d.maskObj=new i,d.view.mask=d.maskObj,d.setMask(n,a),d.maskObj.alpha=0,d.addChild(d.maskObj),d.addChild(d.view),d.maxDistance=s,d.addEventListener(annie.MouseEvent.MOUSE_DOWN,d.onMouseEvent.bind(d)),d.addEventListener(annie.MouseEvent.MOUSE_MOVE,d.onMouseEvent.bind(d)),d.addEventListener(annie.MouseEvent.MOUSE_UP,d.onMouseEvent.bind(d)),d.addEventListener(annie.MouseEvent.MOUSE_OUT,d.onMouseEvent.bind(d)),d.addEventListener(annie.Event.ENTER_FRAME,function(){var e=d.view;d.autoScroll||(d.isStop?d.stopTimes>=0&&(d.stopTimes++,d.stopTimes>=15&&(d.speed=0,(e[d.paramXY]>0||e[d.paramXY]<d.distance-d.maxDistance)&&(d.isStop=!1,d.stopTimes=-1))):Math.abs(d.speed)>0?(e[d.paramXY]+=d.speed,e[d.paramXY]>0||e[d.paramXY]<d.distance-d.maxDistance?d.speed+=d.addSpeed*d.fSpeed:d.speed+=d.addSpeed,d.speed*d.addSpeed>0&&(d.speed=0)):e[d.paramXY]>0||e[d.paramXY]<d.distance-d.maxDistance?d.addSpeed<0?(e[d.paramXY]+=.4*(0-e[d.paramXY]),Math.abs(e[d.paramXY])<.2&&(d.isStop=!0)):(e[d.paramXY]+=.4*(d.distance-d.maxDistance-e[d.paramXY]),Math.abs(d.distance-d.maxDistance-e[d.paramXY])<.2&&(d.isStop=!0)):d.isStop=!0)})}return __extends(n,e),n.prototype.changeDirection=function(e){void 0===e&&(e=!0);var t=this;t.isVertical=e,e?(t.distance=t.viewHeight,t.paramXY="y"):(t.distance=t.viewWidth,t.paramXY="x")},n.prototype.setMask=function(e,t){var i=this;i.maskObj.clear(),i.maskObj.beginFill("#000000"),i.maskObj.drawRect(0,0,e,t),i.viewWidth=e,i.viewHeight=t,i.maskObj.endFill(),i.isVertical?(i.distance=i.viewHeight,i.paramXY="y"):(i.distance=i.viewWidth,i.paramXY="x")},n.prototype.onMouseEvent=function(e){var t=this;if(!t.autoScroll){var i=t.view;if(t.distance<t.maxDistance)if(e.type==annie.MouseEvent.MOUSE_DOWN)t.isStop||(t.isStop=!0),t.isVertical?t.lastValue=e.localY:t.lastValue=e.localX,t.speed=0,t.isMouseDown=!0;else if(e.type==annie.MouseEvent.MOUSE_MOVE){if(!t.isMouseDown)return;var n=void 0;if(n=t.isVertical?e.localY:e.localX,t.speed=n-t.lastValue,t.speed>t.minDis?(t.addSpeed=-2,t.speed>t.maxSpeed&&(t.speed=t.maxSpeed)):t.speed<-t.minDis?(t.speed<-t.maxSpeed&&(t.speed=-t.maxSpeed),t.addSpeed=2):t.speed=0,0!=t.speed){var a=1;(i[t.paramXY]>0||i[t.paramXY]<t.distance-t.maxDistance)&&(a=.2),i[t.paramXY]+=(n-t.lastValue)*a}t.lastValue=n,t.stopTimes=0}else t.isMouseDown=!1,t.isStop=!1,t.stopTimes=-1}},n.prototype.scrollTo=function(e,t){void 0===t&&(t=0);var i=this;i.autoScroll=!0,i.isStop=!0,i.isMouseDown=!1;var n={};n.onComplete=function(){i.autoScroll=!1},n[i.paramXY]=e,annie.Tween.to(i.view,t,n)},n}(t);e.ScrollPage=n}(annieUI||(annieUI={}));var annieUI;!function(e){var t=annie.Sprite,i=function(e){function t(){e.call(this),this.maskType=0;var t=this;t._instanceType="annieUI.FacePhoto",t.photo=new Image,t.bitmap=new annie.Bitmap,t.maskObj=new annie.Shape,t.photo.onload=function(e){if(t.bitmap.bitmapData=t.photo,t.maskObj.clear(),t.maskObj.beginFill("#000000"),0==t.maskType)t.bitmap.scaleX=t.bitmap.scaleY=2*t.radio/t.photo.width,t.maskObj.drawCircle(t.radio,t.radio,t.radio);else{var i=t.photo.width>t.photo.height?t.photo.width:t.photo.height;t.bitmap.scaleX=t.bitmap.scaleY=t.radio/i,t.maskObj.drawRect(0,0,t.radio,t.radio)}t.maskObj.endFill()},t.addChild(t.bitmap),t.bitmap.mask=t.maskObj}return __extends(t,e),t.prototype.init=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.radio=t,this.photo.src=e,this.maskType=i},t}(t);e.FacePhoto=i}(annieUI||(annieUI={}));var annieUI;!function(e){var t=annie.Sprite,i=function(e){function t(t){e.call(this),this.listLen=0,this.slideSpeed=0,this.touchStartX=0,this.touchStartY=0,this.touchEndX=0,this.touchEndY=0,this.currentPageIndex=0,this.isMoving=!1,this.stageW=0,this.stageH=0,this.distance=0,this.fSpeed=10,this.isMouseDown=!1,this.canSlideNext=!0,this.canSlidePrev=!0,this.slideDirection="next",this.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)};var i=this;if(i._instanceType="annieUI.SlidePages",!i.isArray(t.pageList))throw"pageList参数数据格式不对！pageList应为页面对象列表数组";if(!i.isFunction(t.callback))throw"callback参数数据格式不对！callback应为函数";i.pageList=t.pageList,i.callback=t.callback,i.isVertical=t.isVertical?t.isVertical:!0,i.canSlidePrev=t.canSlidePrev?t.canSlidePrev:!0,i.canSlideNext=t.canSlideNext?t.canSlideNext:!0,i.slideSpeed=t.slideSpeed?t.slideSpeed:.4,i.addEventListener(annie.Event.ADD_TO_STAGE,i.onAddToStage.bind(i))}return __extends(t,e),t.prototype.isFunction=function(e){return"function"==typeof e},t.prototype.onAddToStage=function(e){var t=this;t.stageW=t.stage.desWidth,t.stageH=t.stage.desHeight,t.listLen=t.pageList.length,t.slideCon=new annie.Sprite;for(var i=0;i<t.listLen;i++)t.pageList[i].pageId=i,t.pageList[i].visible=!0,t.pageList[i].canSlidePrev=!0,t.pageList[i].canSlideNext=!0,t.isVertical?t.pageList[i].y=i*t.stageH:t.pageList[i].x=i*t.stageW,t.pageList[0].visible=!0,t.slideCon.addChild(t.pageList[i]);t.isMoving&&(t.slideCon.mouseEnable=!1,t.slideCon.mouseChildren=!1),t.slideCon.addEventListener(annie.MouseEvent.MOUSE_DOWN,t.onMouseEventHandler.bind(t)),t.slideCon.addEventListener(annie.MouseEvent.MOUSE_MOVE,t.onMouseEventHandler.bind(t)),t.slideCon.addEventListener(annie.MouseEvent.MOUSE_UP,t.onMouseEventHandler.bind(t)),t.addChild(t.slideCon)},t.prototype.onMouseEventHandler=function(e){var t=this;if(!t.isMoving)if(e.type==annie.MouseEvent.MOUSE_DOWN)t.touchStartX=e.stageX,t.touchStartY=e.stageY,t.isMouseDown=!0;else if(e.type==annie.MouseEvent.MOUSE_MOVE){if(!t.isMouseDown)return;t.touchEndX=e.stageX,t.touchEndY=e.stageY,t.isVertical?(0==t.currentPageIndex&&t.touchStartY<t.touchEndY&&(t.slideCon.y+=Math.abs(t.touchStartY-t.touchEndY)/t.stageH*t.fSpeed*.6),t.currentPageIndex==t.listLen-1&&t.touchStartY>t.touchEndY&&(t.slideCon.y-=Math.abs(t.touchStartY-t.touchEndY)/t.stageH*t.fSpeed*.6)):(0==t.currentPageIndex&&t.touchStartX<t.touchEndX&&(t.slideCon.x+=Math.abs(t.touchStartX-t.touchEndX)/t.stageW*t.fSpeed*.6),t.currentPageIndex==t.listLen-1&&t.touchStartX>t.touchEndX&&(t.slideCon.x-=Math.abs(t.touchStartX-t.touchEndX)/t.stageW*t.fSpeed*.6))}else if(e.type==annie.MouseEvent.MOUSE_UP){if(t.isMoving)return;if(t.isMouseDown=!1,t.touchEndX=e.stageX,t.touchEndY=e.stageY,t.distance=t.getDistance(t.touchStartX,t.touchStartY,t.touchEndX,t.touchEndY),t.distance>24)if(t.isVertical?t.slideDirection=t.touchStartY>t.touchEndY?"next":"prev":t.slideDirection=t.touchStartX>t.touchEndX?"next":"prev","next"==t.slideDirection)if(globalDispatcher.dispatchEvent("onSlideNextEvent"),t.currentPageIndex<t.listLen-1){if(!t.canSlideNext||!t.pageList[t.currentPageIndex].canSlideNext)return;t.currentPageIndex++,t.slideTo(t.currentPageIndex)}else 1==t.isVertical?annie.Tween.to(t.slideCon,.2,{y:-t.stageH*(t.listLen-1),ease:annie.Tween.backOut}):annie.Tween.to(t.slideCon,.2,{x:-t.stageW*(t.listLen-1),ease:annie.Tween.backOut});else if(globalDispatcher.dispatchEvent("onSlidePrevEvent"),t.currentPageIndex>0){if(!t.canSlidePrev||!t.pageList[t.currentPageIndex].canSlidePrev)return;t.currentPageIndex--,t.slideTo(t.currentPageIndex)}else 1==t.isVertical?annie.Tween.to(t.slideCon,.2,{y:0,ease:annie.Tween.backOut}):annie.Tween.to(t.slideCon,.2,{x:0,ease:annie.Tween.backOut})}},t.prototype.slideTo=function(e){var t=this;t.isMoving||(t.isVertical?(annie.Tween.to(t.slideCon,t.slideSpeed,{y:-e*t.stage.desHeight,onComplete:function(){t.isFunction(t.callback)&&t.callback(e),t.slideCon.mouseEnable=!0,t.slideCon.mouseChildren=!0,t.isMoving=!1}}),t.isMoving=!0):(annie.Tween.to(t.slideCon,t.slideSpeed,{x:-e*t.stage.desWidth,onComplete:function(){t.isFunction(t.callback)&&t.callback(e),t.slideCon.mouseEnable=!0,t.slideCon.mouseChildren=!0,t.isMoving=!1}}),t.isMoving=!0),t.currentPageIndex=e)},t.prototype.addPageList=function(e){var t=this;if(!t.isArray(e))throw"list应为页面对象列表数组";for(var i=e.length,n=0;i>n;n++)e[n].pageId=t.listLen,e[n].visible=!0,e[n].canSlidePrev=!0,e[n].canSlideNext=!0,t.isVertical?e[n].y=t.listLen*t.stageH:e[n].x=t.listLen*t.stageW,t.pageList.push(e[n]),t.listLen=t.pageList.length,t.slideCon.addChildAt(e[n],t.listLen)},t.prototype.getDistance=function(e,t,i,n){var a=i-e,s=n-t,o=Math.pow(a*a+s*s,.5);return o},t}(t);e.SlidePage=i}(annieUI||(annieUI={}));